"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _ramda = require("ramda");
var _net = _interopRequireDefault(require("net"));
var _tls = _interopRequireDefault(require("tls"));
var _httpProxyClient = _interopRequireDefault(require("./http-proxy-client.js"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
class TCPSocket {
  static open(host, port, options = {}) {
    return new TCPSocket({
      host,
      port,
      options
    });
  }
  constructor({
    host,
    port,
    options
  }) {
    this.host = host;
    this.port = port;
    this.ssl = (0, _ramda.propOr)(false, 'useSecureTransport')(options);
    this.bufferedAmount = 0;
    this.readyState = 'connecting';
    this.binaryType = (0, _ramda.propOr)('arraybuffer', 'binaryType')(options);
    if (this.binaryType !== 'arraybuffer') {
      throw new Error('Only arraybuffers are supported!');
    }
    if (options.proxy) {
      this._socket = (0, _httpProxyClient.default)(options.proxy, this.port, this.host, err => {
        if (err) return this._emit('error', err);
        // Upgrade to SSL connection if using secure connection
        if (this.ssl) {
          this._socket = _tls.default.connect({
            socket: this._socket,
            host: this.host,
            servername: this.host // SNI
          }, () => {
            this.ssl = true;
          });
        }
        this._attachListeners();
        this._emit('open');
      });
    } else {
      this._socket = this.ssl ? _tls.default.connect({
        port: this.port,
        host: this.host,
        minVersion: options.minTLSVersion || _tls.default.DEFAULT_MIN_VERSION,
        maxVersion: options.maxTLSVersion || _tls.default.DEFAULT_MAX_VERSION,
        servername: this.host // SNI
      }, () => this._emit('open')) : _net.default.connect(this.port, this.host, () => this._emit('open'));
      // add all event listeners to the new socket
      this._attachListeners();
    }
  }
  _attachListeners() {
    this._socket.on('data', nodeBuf => this._emit('data', nodeBuffertoArrayBuffer(nodeBuf)));
    this._socket.on('error', error => {
      // Ignore ECONNRESET errors. For the app this is the same as normal close
      if (error.code !== 'ECONNRESET') {
        this._emit('error', error);
      }
      this.close();
    });
    this._socket.on('end', () => this._emit('close'));
  }
  _removeListeners() {
    this._socket.removeAllListeners('data');
    this._socket.removeAllListeners('end');
    this._socket.removeAllListeners('error');
  }
  _emit(type, data) {
    const target = this;
    switch (type) {
      case 'open':
        this.readyState = 'open';
        this.onopen && this.onopen({
          target,
          type,
          data
        });
        break;
      case 'error':
        this.onerror && this.onerror({
          target,
          type,
          data
        });
        break;
      case 'data':
        this.ondata && this.ondata({
          target,
          type,
          data
        });
        break;
      case 'drain':
        this.ondrain && this.ondrain({
          target,
          type,
          data
        });
        break;
      case 'close':
        this.readyState = 'closed';
        this.onclose && this.onclose({
          target,
          type,
          data
        });
        break;
    }
  }

  //
  // API
  //

  close() {
    this.readyState = 'closing';
    this._socket.end();
  }
  send(data) {
    // convert data to string or node buffer
    this._socket.write(arrayBufferToNodeBuffer(data), this._emit.bind(this, 'drain'));
  }
  upgradeToSecure() {
    if (this.ssl) return;
    this._removeListeners();
    this._socket = _tls.default.connect({
      host: this.host,
      servername: this.host,
      // SNI
      socket: this._socket
    }, () => {
      this.ssl = true;
    });
    this._attachListeners();
  }
}
exports.default = TCPSocket;
const nodeBuffertoArrayBuffer = buf => Uint8Array.from(buf).buffer;
const arrayBufferToNodeBuffer = ab => Buffer.from(new Uint8Array(ab));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmFtZGEiLCJyZXF1aXJlIiwiX25ldCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfdGxzIiwiX2h0dHBQcm94eUNsaWVudCIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlRDUFNvY2tldCIsIm9wZW4iLCJob3N0IiwicG9ydCIsIm9wdGlvbnMiLCJjb25zdHJ1Y3RvciIsInNzbCIsInByb3BPciIsImJ1ZmZlcmVkQW1vdW50IiwicmVhZHlTdGF0ZSIsImJpbmFyeVR5cGUiLCJFcnJvciIsInByb3h5IiwiX3NvY2tldCIsImh0dHBQcm94eUNsaWVudCIsImVyciIsIl9lbWl0IiwidGxzIiwiY29ubmVjdCIsInNvY2tldCIsInNlcnZlcm5hbWUiLCJfYXR0YWNoTGlzdGVuZXJzIiwibWluVmVyc2lvbiIsIm1pblRMU1ZlcnNpb24iLCJERUZBVUxUX01JTl9WRVJTSU9OIiwibWF4VmVyc2lvbiIsIm1heFRMU1ZlcnNpb24iLCJERUZBVUxUX01BWF9WRVJTSU9OIiwibmV0Iiwib24iLCJub2RlQnVmIiwibm9kZUJ1ZmZlcnRvQXJyYXlCdWZmZXIiLCJlcnJvciIsImNvZGUiLCJjbG9zZSIsIl9yZW1vdmVMaXN0ZW5lcnMiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJ0eXBlIiwiZGF0YSIsInRhcmdldCIsIm9ub3BlbiIsIm9uZXJyb3IiLCJvbmRhdGEiLCJvbmRyYWluIiwib25jbG9zZSIsImVuZCIsInNlbmQiLCJ3cml0ZSIsImFycmF5QnVmZmVyVG9Ob2RlQnVmZmVyIiwiYmluZCIsInVwZ3JhZGVUb1NlY3VyZSIsImV4cG9ydHMiLCJidWYiLCJVaW50OEFycmF5IiwiZnJvbSIsImJ1ZmZlciIsImFiIiwiQnVmZmVyIl0sInNvdXJjZXMiOlsiLi4vc3JjL25vZGUtc29ja2V0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByb3BPciB9IGZyb20gJ3JhbWRhJ1xuaW1wb3J0IG5ldCBmcm9tICduZXQnXG5pbXBvcnQgdGxzIGZyb20gJ3RscydcbmltcG9ydCBodHRwUHJveHlDbGllbnQgZnJvbSAnLi9odHRwLXByb3h5LWNsaWVudC5qcydcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVENQU29ja2V0IHtcbiAgc3RhdGljIG9wZW4gKGhvc3QsIHBvcnQsIG9wdGlvbnMgPSB7fSkge1xuICAgIHJldHVybiBuZXcgVENQU29ja2V0KHsgaG9zdCwgcG9ydCwgb3B0aW9ucyB9KVxuICB9XG5cbiAgY29uc3RydWN0b3IgKHsgaG9zdCwgcG9ydCwgb3B0aW9ucyB9KSB7XG4gICAgdGhpcy5ob3N0ID0gaG9zdFxuICAgIHRoaXMucG9ydCA9IHBvcnRcbiAgICB0aGlzLnNzbCA9IHByb3BPcihmYWxzZSwgJ3VzZVNlY3VyZVRyYW5zcG9ydCcpKG9wdGlvbnMpXG4gICAgdGhpcy5idWZmZXJlZEFtb3VudCA9IDBcbiAgICB0aGlzLnJlYWR5U3RhdGUgPSAnY29ubmVjdGluZydcbiAgICB0aGlzLmJpbmFyeVR5cGUgPSBwcm9wT3IoJ2FycmF5YnVmZmVyJywgJ2JpbmFyeVR5cGUnKShvcHRpb25zKVxuXG4gICAgaWYgKHRoaXMuYmluYXJ5VHlwZSAhPT0gJ2FycmF5YnVmZmVyJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdPbmx5IGFycmF5YnVmZmVycyBhcmUgc3VwcG9ydGVkIScpXG4gICAgfVxuICAgIGlmIChvcHRpb25zLnByb3h5KSB7XG4gICAgICB0aGlzLl9zb2NrZXQgPSBodHRwUHJveHlDbGllbnQob3B0aW9ucy5wcm94eSwgdGhpcy5wb3J0LCB0aGlzLmhvc3QsIGVyciA9PiB7XG4gICAgICAgIGlmIChlcnIpIHJldHVybiB0aGlzLl9lbWl0KCdlcnJvcicsIGVycilcbiAgICAgICAgLy8gVXBncmFkZSB0byBTU0wgY29ubmVjdGlvbiBpZiB1c2luZyBzZWN1cmUgY29ubmVjdGlvblxuICAgICAgICBpZiAodGhpcy5zc2wpIHtcbiAgICAgICAgICB0aGlzLl9zb2NrZXQgPSB0bHMuY29ubmVjdCh7XG4gICAgICAgICAgICBzb2NrZXQ6IHRoaXMuX3NvY2tldCxcbiAgICAgICAgICAgIGhvc3Q6IHRoaXMuaG9zdCxcbiAgICAgICAgICAgIHNlcnZlcm5hbWU6IHRoaXMuaG9zdCAvLyBTTklcbiAgICAgICAgICB9LCAoKSA9PiB7IHRoaXMuc3NsID0gdHJ1ZSB9KVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2F0dGFjaExpc3RlbmVycygpXG4gICAgICAgIHRoaXMuX2VtaXQoJ29wZW4nKVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc29ja2V0ID0gdGhpcy5zc2wgPyAoXG4gICAgICAgIHRscy5jb25uZWN0KHtcbiAgICAgICAgICBwb3J0OiB0aGlzLnBvcnQsXG4gICAgICAgICAgaG9zdDogdGhpcy5ob3N0LFxuICAgICAgICAgIG1pblZlcnNpb246IG9wdGlvbnMubWluVExTVmVyc2lvbiB8fCB0bHMuREVGQVVMVF9NSU5fVkVSU0lPTixcbiAgICAgICAgICBtYXhWZXJzaW9uOiBvcHRpb25zLm1heFRMU1ZlcnNpb24gfHwgdGxzLkRFRkFVTFRfTUFYX1ZFUlNJT04sXG4gICAgICAgICAgc2VydmVybmFtZTogdGhpcy5ob3N0IC8vIFNOSVxuICAgICAgICB9LCAoKSA9PiB0aGlzLl9lbWl0KCdvcGVuJykpKSA6IChcbiAgICAgICAgbmV0LmNvbm5lY3QodGhpcy5wb3J0LCB0aGlzLmhvc3QsICgpID0+IHRoaXMuX2VtaXQoJ29wZW4nKSlcbiAgICAgIClcbiAgICAgIC8vIGFkZCBhbGwgZXZlbnQgbGlzdGVuZXJzIHRvIHRoZSBuZXcgc29ja2V0XG4gICAgICB0aGlzLl9hdHRhY2hMaXN0ZW5lcnMoKVxuICAgIH1cbiAgfVxuXG4gIF9hdHRhY2hMaXN0ZW5lcnMgKCkge1xuICAgIHRoaXMuX3NvY2tldC5vbignZGF0YScsIG5vZGVCdWYgPT4gdGhpcy5fZW1pdCgnZGF0YScsIG5vZGVCdWZmZXJ0b0FycmF5QnVmZmVyKG5vZGVCdWYpKSlcbiAgICB0aGlzLl9zb2NrZXQub24oJ2Vycm9yJywgZXJyb3IgPT4ge1xuICAgICAgLy8gSWdub3JlIEVDT05OUkVTRVQgZXJyb3JzLiBGb3IgdGhlIGFwcCB0aGlzIGlzIHRoZSBzYW1lIGFzIG5vcm1hbCBjbG9zZVxuICAgICAgaWYgKGVycm9yLmNvZGUgIT09ICdFQ09OTlJFU0VUJykge1xuICAgICAgICB0aGlzLl9lbWl0KCdlcnJvcicsIGVycm9yKVxuICAgICAgfVxuICAgICAgdGhpcy5jbG9zZSgpXG4gICAgfSlcblxuICAgIHRoaXMuX3NvY2tldC5vbignZW5kJywgKCkgPT4gdGhpcy5fZW1pdCgnY2xvc2UnKSlcbiAgfVxuXG4gIF9yZW1vdmVMaXN0ZW5lcnMgKCkge1xuICAgIHRoaXMuX3NvY2tldC5yZW1vdmVBbGxMaXN0ZW5lcnMoJ2RhdGEnKVxuICAgIHRoaXMuX3NvY2tldC5yZW1vdmVBbGxMaXN0ZW5lcnMoJ2VuZCcpXG4gICAgdGhpcy5fc29ja2V0LnJlbW92ZUFsbExpc3RlbmVycygnZXJyb3InKVxuICB9XG5cbiAgX2VtaXQgKHR5cGUsIGRhdGEpIHtcbiAgICBjb25zdCB0YXJnZXQgPSB0aGlzXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdvcGVuJzpcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gJ29wZW4nXG4gICAgICAgIHRoaXMub25vcGVuICYmIHRoaXMub25vcGVuKHsgdGFyZ2V0LCB0eXBlLCBkYXRhIH0pXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdlcnJvcic6XG4gICAgICAgIHRoaXMub25lcnJvciAmJiB0aGlzLm9uZXJyb3IoeyB0YXJnZXQsIHR5cGUsIGRhdGEgfSlcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ2RhdGEnOlxuICAgICAgICB0aGlzLm9uZGF0YSAmJiB0aGlzLm9uZGF0YSh7IHRhcmdldCwgdHlwZSwgZGF0YSB9KVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAnZHJhaW4nOlxuICAgICAgICB0aGlzLm9uZHJhaW4gJiYgdGhpcy5vbmRyYWluKHsgdGFyZ2V0LCB0eXBlLCBkYXRhIH0pXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdjbG9zZSc6XG4gICAgICAgIHRoaXMucmVhZHlTdGF0ZSA9ICdjbG9zZWQnXG4gICAgICAgIHRoaXMub25jbG9zZSAmJiB0aGlzLm9uY2xvc2UoeyB0YXJnZXQsIHR5cGUsIGRhdGEgfSlcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICAvL1xuICAvLyBBUElcbiAgLy9cblxuICBjbG9zZSAoKSB7XG4gICAgdGhpcy5yZWFkeVN0YXRlID0gJ2Nsb3NpbmcnXG4gICAgdGhpcy5fc29ja2V0LmVuZCgpXG4gIH1cblxuICBzZW5kIChkYXRhKSB7XG4gICAgLy8gY29udmVydCBkYXRhIHRvIHN0cmluZyBvciBub2RlIGJ1ZmZlclxuICAgIHRoaXMuX3NvY2tldC53cml0ZShhcnJheUJ1ZmZlclRvTm9kZUJ1ZmZlcihkYXRhKSwgdGhpcy5fZW1pdC5iaW5kKHRoaXMsICdkcmFpbicpKVxuICB9XG5cbiAgdXBncmFkZVRvU2VjdXJlICgpIHtcbiAgICBpZiAodGhpcy5zc2wpIHJldHVyblxuXG4gICAgdGhpcy5fcmVtb3ZlTGlzdGVuZXJzKClcbiAgICB0aGlzLl9zb2NrZXQgPSB0bHMuY29ubmVjdCh7XG4gICAgICBob3N0OiB0aGlzLmhvc3QsXG4gICAgICBzZXJ2ZXJuYW1lOiB0aGlzLmhvc3QsIC8vIFNOSVxuICAgICAgc29ja2V0OiB0aGlzLl9zb2NrZXRcbiAgICB9LCAoKSA9PiB7IHRoaXMuc3NsID0gdHJ1ZSB9KVxuICAgIHRoaXMuX2F0dGFjaExpc3RlbmVycygpXG4gIH1cbn1cblxuY29uc3Qgbm9kZUJ1ZmZlcnRvQXJyYXlCdWZmZXIgPSBidWYgPT4gVWludDhBcnJheS5mcm9tKGJ1ZikuYnVmZmVyXG5jb25zdCBhcnJheUJ1ZmZlclRvTm9kZUJ1ZmZlciA9IChhYikgPT4gQnVmZmVyLmZyb20obmV3IFVpbnQ4QXJyYXkoYWIpKVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxNQUFBLEdBQUFDLE9BQUE7QUFDQSxJ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